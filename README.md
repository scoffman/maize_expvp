### Helper scripts for haplotype analysis
Owner: Stephanie Coffman


#### **Introduction**

This repository contains helper scripts and example files that were used in analysis of haplotype data generated by the FILLINFindHaplotypes Plugin in [TASSEL 5.0](https://tassel.bitbucket.io/) for the publication below.

Coffman, S.M., Hufford, M.B., Andorf, C.M. et al. Haplotype structure in commercial maize breeding programs in relation to key founder lines. Theor Appl Genet 133, 547-561 (2020). [https://doi.org/10.1007/s00122-019-03486-y](https://doi.org/10.1007/s00122-019-03486-y)


#### **Methods**

#### **`/scripts/convert_fillinhaps_to_feather_or_csv.R`**

The FILLINFindHaplotypes Plugin generates two txt files per SNP window. This can lead to a large number of files. This script takes all of those files and combines it to two output files. 


#### **`/scripts/apply_hierarchy.R`**

The objective of this script is to rename all haplotype groups across all SNP windows such that the naming schemes are consistent from window to window. A major benefit of doing this is that it provides consistent coloring of haplotypes when they are visualized across samples and SNP windows. The hierarchy should be structured such that important or key samples are at the top. The hierarchy order directly impacts how the downstream visualization looks, because of shared haplotypes across samples.

This script takes two inputs: 

1. <u>Haplotype file</u>

    hap_results.csv (or .feather) exported from `convert_fillinhaps_to_feather_or_csv.R` that contains haplotype group assignments for samples by SNP window

2. <u>Hierarchy file</u>

    hierarchy.csv set up by the user

    This file contains 3 columns: 

    - order: integer that acts as an ordered index value to specify how haplotype groups should be renamed
    - sample: names of all samples that have haplotype data
    - Hex_Code: hex code that represents a color that can be used downstream to color haplotypes in visualizations